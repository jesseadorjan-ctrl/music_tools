<!DOCTYPE html>
<html>
<head>
  <title>Music Tool</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { margin:0; font-family:'Arial', sans-serif; background-color:#6d4d86; display:flex; flex-direction:column; align-items:center; padding:10px 0;}
    .tool-container { display:flex; flex-wrap:wrap; width:90%; max-width:800px; background-color:#B679C5; border-radius:15px; padding:15px; box-sizing:border-box; gap:15px; justify-content:center;}
    .mode-selector { flex:1 1 110px; display:flex; flex-direction:column; justify-content:space-evenly; background: rgba(0,0,0,0.15); border-radius:15px; padding:10px; min-width:110px;}
    .mode-button { background:#6d4d86; color:#fff; border:none; padding:6px 0; font-size:16px; cursor:pointer; border-radius:10px; text-align:center; transition:0.3s; margin:4px 0; display:flex; align-items:center; justify-content:center;}
    .mode-button:hover {background:#9b35c8;}
    .mode-button.selected {background:#fda4f7;color:#000;}
    .keyboard-container { flex:2 1 300px; position:relative; display:flex; width:100%; height:160px;}
    .white-keys { display:flex; width:100%; height:100%; position:relative;}
    .white-key { flex:1; margin:0 1px; background:white; border-radius:4px; position:relative; cursor:pointer; display:flex; align-items:flex-end; justify-content:center;}
    .white-key span { color:#4b007a; font-weight:bold; font-size:14px; margin-bottom:4px;}
    .white-key:hover {background:#9b35c8;}
    .white-key.selected {background:#fda4f7;}
    .black-keys { position:absolute; top:0; left:0; width:100%; height:60%; pointer-events:none;}
    .black-key { position:absolute; width:calc(100%/12); height:100%; background:black; border-radius:4px; cursor:pointer; pointer-events:auto; display:flex; align-items:flex-end; justify-content:center;}
    .black-key span { color:#f9e8ff; font-weight:bold; font-size:12px; margin-bottom:3px;}
    .black-key:hover {background:#9b35c8;}
    .black-key.selected {background:#fda4f7;}
    .controls-container { width:90%; max-width:900px; margin-top:10px; display:flex; flex-direction:column; gap:10px; align-items:center;}
    .vaporwave-button { background-color:#B679C5; color:white; border:none; padding:6px 10px; font-size:18px; font-weight:bold; border-radius:5px; cursor:pointer; transition:background-color 0.3s; width:90%; max-width:250px;}
    .vaporwave-button:hover {background-color:#DFA1E6;}
    .result { margin-top:5px; background: rgba(255,255,255,0.2); padding:10px; border-radius:10px; color:#000; font-weight:bold; white-space:pre-line; width:90%; max-width:250px; text-align:center; word-wrap:break-word;}
  </style>
</head>
<body>

<div class="tool-container">
  <div class="mode-selector" id="modeSelector">
    <div class="mode-button" onclick="selectMode('Ionian')">Ionian</div>
    <div class="mode-button" onclick="selectMode('Dorian')">Dorian</div>
    <div class="mode-button" onclick="selectMode('Phrygian')">Phrygian</div>
    <div class="mode-button" onclick="selectMode('Lydian')">Lydian</div>
    <div class="mode-button" onclick="selectMode('Mixolydian')">Mixolydian</div>
    <div class="mode-button" onclick="selectMode('Aeolian')">Aeolian</div>
    <div class="mode-button" onclick="selectMode('Locrian')">Locrian</div>
  </div>

  <div class="keyboard-container">
    <div class="white-keys" id="whiteKeys">
      <div class="white-key" data-note="C"><span>C</span></div>
      <div class="white-key" data-note="D"><span>D</span></div>
      <div class="white-key" data-note="E"><span>E</span></div>
      <div class="white-key" data-note="F"><span>F</span></div>
      <div class="white-key" data-note="G"><span>G</span></div>
      <div class="white-key" data-note="A"><span>A</span></div>
      <div class="white-key" data-note="B"><span>B</span></div>
    </div>
    <div class="black-keys">
      <div class="black-key" data-note="C#" style="left:10%;"><span>C#</span></div>
      <div class="black-key" data-note="D#" style="left:24.5%;"><span>D#</span></div>
      <div class="black-key" data-note="F#" style="left:53%;"><span>F#</span></div>
      <div class="black-key" data-note="G#" style="left:67.5%;"><span>G#</span></div>
      <div class="black-key" data-note="A#" style="left:81.5%;"><span>A#</span></div>
    </div>
  </div>
</div>

<div class="controls-container">
  <button class="vaporwave-button" onclick="displayRandomChords()">Generate Chords</button>
  <div class="result" id="result_label">Random chords will appear here.</div>
  <button class="vaporwave-button" onclick="displayRandomBassLines()">Generate Basslines</button>
  <div class="result" id="bassresult_label">Random basslines will appear here.</div>
</div>

<script>
let selectedKey = null;
let selectedMode = null;

/* Key selection */
document.querySelectorAll('.white-key, .black-key').forEach(k=>{
  k.addEventListener('click', ()=>{
    selectedKey=k.dataset.note;
    document.querySelectorAll('.white-key, .black-key').forEach(x=>x.classList.remove('selected'));
    k.classList.add('selected');
  });
});

/* Mode selection */
function selectMode(mode){
  selectedMode=mode;
  document.querySelectorAll('.mode-button').forEach(btn=>btn.classList.remove('selected'));
  document.querySelectorAll('.mode-button').forEach(btn=>{
    if(btn.textContent===mode) btn.classList.add('selected');
  });
}

/* Chord generator: diatonic only */
function displayRandomChords(){
  if(!selectedKey||!selectedMode){ alert("Select key and mode"); return; }
  const chords = generateChords(selectedKey, selectedMode);
  document.getElementById('result_label').textContent = `Chords for ${selectedKey} ${selectedMode}:\n${chords.join(', ')}`;
}

function generateChords(key, mode){
  const notes=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];
  const modeIntervals = {
    Ionian:[0,2,4,5,7,9,11],
    Dorian:[0,2,3,5,7,9,10],
    Phrygian:[0,1,3,5,7,8,10],
    Lydian:[0,2,4,6,7,9,11],
    Mixolydian:[0,2,4,5,7,9,10],
    Aeolian:[0,2,3,5,7,8,10],
    Locrian:[0,1,3,5,6,8,10]
  };
  const modeChords = {
    Ionian:["maj","m","m","maj","maj","m","dim"],
    Dorian:["m","m","maj","maj","m","dim","maj"],
    Phrygian:["m","maj","maj","m","dim","maj","m"],
    Lydian:["maj","maj","m","dim","maj","m","m"],
    Mixolydian:["maj","m","dim","maj","m","m","maj"],
    Aeolian:["m","dim","maj","m","m","maj","maj"],
    Locrian:["dim","maj","m","m","maj","maj","m"]
  };
  const rootIndex = notes.indexOf(key);
  const scale = modeIntervals[mode].map(i => notes[(rootIndex + i)%12]);
  const chords = scale.map((note,i)=> note + modeChords[mode][i]);
  return Array.from({length:4}, ()=> chords[Math.floor(Math.random()*chords.length)]);
}

/* Bassline generator (random) */
function displayRandomBassLines(){
  if(!selectedKey||!selectedMode){ alert("Select key and mode"); return; }
  const basslines = generateBass(selectedKey);
  document.getElementById('bassresult_label').textContent = `Basslines for ${selectedKey} ${selectedMode}:\n${basslines.join(' - ')}`;
}
function generateBass(key){
  const notes=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];
  return Array.from({length:4},()=> notes[(notes.indexOf(key)+Math.floor(Math.random()*12))%12]);
}
</script>

</body>
</html>
